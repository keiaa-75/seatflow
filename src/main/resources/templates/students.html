<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{fragments/head :: head('Manage Student Entries')}"></head>
<body>
    <th:block th:insert="~{fragments/navbar :: navbar}"></th:block>
    
    <th:block th:insert="~{fragments/title-card :: titleCard('Manage Student Entries', true, '/sections/' + ${sectionId})}"></th:block>
    
    <div>
        <div th:insert="~{fragments/notifications :: notifications}"></div>

        <!-- Content Area -->
        <div class="section-detail-container">
            <!-- Search Bar -->
            <div class="box mb-4">
                <div class="field has-addons mb-4">
                    <div class="control is-expanded">
                        <input type="text" class="input" id="student-search" placeholder="Search students...">
                    </div>
                    <div class="control">
                        <button class="button is-primary">
                            <i class="fas fa-search"></i>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Students List -->
            <div id="students-view">
                <div id="students-list">
                    <th:block th:if="${#lists.isEmpty(students)}">
                        <div class="has-text-centered has-text-grey py-5">
                            No students found. Add your first student to get started.
                        </div>
                    </th:block>
                    
                    <th:block th:if="${!#lists.isEmpty(students)}">
                        <th:block th:each="student : ${students}">
                            <a th:href="@{/sections/{sectionId}/students/edit/{id}(sectionId=${sectionId}, id=${student.studentId})}" 
                               class="box mb-3 is-block student-item"
                               th:attr="data-search-text=${student.displayName + ' ' + student.studentId}">
                                <div>
                                    <span class="has-text-weight-medium" th:text="${student.displayName}">Doe, John M.</span>
                                </div>
                                <div>
                                    <span class="tag is-info is-light" th:text="${student.studentId}">20230001</span>
                                </div>
                            </a>
                        </th:block>
                    </th:block>
                </div>
            </div>
        </div>

        <!-- Floating Action Button -->
        <th:block th:insert="~{fragments/fab :: fab('/sections/' + ${sectionId} + '/students/new')}"></th:block>


        <!-- Student List JavaScript -->
        <script src="/js/search-utils.js"></script>
        <script>
            document.addEventListener('DOMContentLoaded', function() {
                new SearchFilter({
                    searchInput: '#student-search',
                    itemsContainer: '#students-list',
                    itemSelector: '.student-item',
                    searchAttribute: 'data-search-text',
                    noResultsMessage: 'No students found matching your search.',
                    debounceDelay: 0
                });
            });
        </script>
    </div>
</body>
</html>